# Note: This Dockerfile creates a minimal container for the Rust application build inside a CI/CD pipeline.

FROM gcr.io/distroless/cc-debian12

# Copy the Rust server binary from the build context
COPY target/release/server /app

# GITHUB_TOKEN is required for the application to access GitHub API
ENV GITHUB_TOKEN=""

# Set default port (can be overridden)
ENV PORT=3000

# Expose the port specified by PORT environment variable
EXPOSE $PORT

# Set the entrypoint
CMD ["./app"]